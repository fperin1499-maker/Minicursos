<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Interativo Agroecol√≥gico</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chosen Palette: Calm Earth Tones (Base: bg-gray-50, Header: bg-emerald-700, Accents: border-emerald-500, border-blue-500, border-amber-500, border-red-500) -->
    <!-- Application Structure Plan: Single-page application (SPA) using a sticky top navigation bar (M1-M6) to switch between different quiz modules. JavaScript manages the quiz state (current question, score) within each visible section. A visual hub with cards is added to the intro page for better navigation. The core logic is modified to allow users to jump between modules freely, while score completion is still tracked per module. -->
    <!-- Visualization & Content Choices: Content (Questions/Answers/Rationale) -> Goal: Assess Knowledge -> Presentation: HTML Cards/Buttons -> Interaction: Button clicks to progress/show feedback (JS state machine) and Card clicks for module jump -> Justification: Ensures all data (30 questions) is consumable in a logical, segmented, and interactive flow with enhanced freedom of exploration. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap');
        html {
            scroll-behavior: smooth;
        }
        body {
            font-family: 'Inter', sans-serif;
        }
        .nav-link.active-link {
            font-weight: 600;
            background-color: #065f46; 
            border-bottom: 4px solid #ffffff;
        }
        .content-page {
            display: none;
            animation: fadeIn 0.4s ease-in-out;
        }
        .content-page.active {
            display: block;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .answer-option {
            transition: all 0.2s ease-in-out;
        }
        .answer-option:not(.disabled):hover {
            background-color: #f0fdf4; 
            border-color: #34d399;
        }
        .correct {
            background-color: #d1fae5; 
            border-color: #10b981;
            font-weight: 600;
        }
        .incorrect {
            background-color: #fee2e2;
            border-color: #f87171;
            font-weight: 600;
        }
        .disabled {
            cursor: not-allowed;
            opacity: 0.8;
        }
        .module-card {
            transition: transform 0.2s ease-out, box-shadow 0.2s ease-out;
            cursor: pointer;
        }
        .module-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 font-sans">

    <header class="bg-emerald-700 text-white p-4 shadow-lg sticky top-0 z-50">
        <div class="container mx-auto flex flex-col md:flex-row justify-between items-center max-w-7xl">
            <h1 class="text-xl font-bold text-center md:text-left">
                ‚úÖ Quiz Final
            </h1>
            <nav class="mt-4 md:mt-0 w-full md:w-auto">
                <div class="flex flex-wrap justify-center gap-2">
                    <button class="nav-link p-2 px-3 rounded-lg hover:bg-emerald-600 transition-colors" data-target="page-intro" onclick="showPage('page-intro')">In√≠cio</button>
                    <button class="nav-link p-2 px-3 rounded-lg hover:bg-emerald-600 transition-colors" data-target="M1" onclick="showPage('M1')">M1: Pragas</button>
                    <button class="nav-link p-2 px-3 rounded-lg hover:bg-emerald-600 transition-colors" data-target="M2" onclick="showPage('M2')">M2: Doen√ßas</button>
                    <button class="nav-link p-2 px-3 rounded-lg hover:bg-emerald-600 transition-colors" data-target="M3" onclick="showPage('M3')">M3: Daninhas</button>
                    <button class="nav-link p-2 px-3 rounded-lg hover:bg-emerald-600 transition-colors" data-target="M4" onclick="showPage('M4')">M4: Repelentes</button>
                    <button class="nav-link p-2 px-3 rounded-lg hover:bg-emerald-600 transition-colors" data-target="M5" onclick="showPage('M5')">M5: Nutricional</button>
                    <button class="nav-link p-2 px-3 rounded-lg hover:bg-emerald-600 transition-colors" data-target="M6" onclick="showPage('M6')">M6: Receitas</button>
                </div>
            </nav>
        </div>
    </header>

    <main class="container mx-auto p-4 md:p-8 max-w-5xl">

        <!-- ===== P√ÅGINA INICIAL (HUB VISUAL) ===== -->
        <section id="page-intro" class="content-page">
            <div class="bg-white shadow-xl rounded-lg p-6 md:p-8 border-b-4 border-emerald-500">
                <h2 class="text-3xl font-bold text-emerald-800 mb-4">Bem-vindo ao Quiz Interativo!</h2>
                <p class="text-lg text-gray-700 mb-6">
                    Este teste de 30 quest√µes est√° dividido em 6 m√≥dulos. Voc√™ pode pular para qualquer m√≥dulo ou come√ßar pela ordem sequencial.
                </p>
                <div id="hub-cards-container" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                    
                    <!-- Cart√µes dos M√≥dulos (Conte√∫do gerado via JS) -->
                    
                </div>
                <button class="mt-8 bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-3 px-6 rounded-lg transition-colors" onclick="showPage('M1')">
                    Come√ßar o Quiz (M√≥dulo 1)
                </button>
            </div>
        </section>

        <!-- ===== M√ìDULOS DO QUIZ (M1 a M6) ===== -->
        <!-- O conte√∫do ser√° gerado dinamicamente via JS na div #quiz-content -->
        <div id="quiz-content">
            <!-- As se√ß√µes de quiz (content-page) ser√£o inseridas aqui pelo JS -->
        </div>

        <!-- ===== P√ÅGINA FINAL DE RESUMO GERAL ===== -->
        <section id="page-final" class="content-page">
            <div class="bg-white shadow-xl rounded-lg p-6 md:p-8 border-b-4 border-emerald-500">
                <h2 class="text-3xl font-bold text-emerald-800 mb-4">üèÜ Fim do Quiz - Resumo Geral</h2>
                <p class="text-lg text-gray-700 mb-6">Parab√©ns! Voc√™ completou todos os m√≥dulos do quiz. Veja seu desempenho final:</p>
                <div class="bg-gray-100 p-6 rounded-lg">
                    <h3 class="text-xl font-bold text-gray-900 mb-3">Performance por M√≥dulo</h3>
                    <ul id="final-summary-list" class="list-none space-y-2">
                        <!-- Resultados ser√£o injetados aqui -->
                    </ul>
                    <div class="mt-6 pt-4 border-t border-gray-300">
                        <p class="text-2xl font-extrabold text-emerald-600">Pontua√ß√£o Total: <span id="final-total-score">0 / 30</span></p>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <footer class="text-center p-6 mt-12 text-gray-500 text-sm">
        Quiz Interativo Agroecol√≥gico | 2025
    </footer>

    <script>
        const QUIZ_DATA = {
            "M1": {
                "title": "Manejo de Pragas (MAP)",
                "icon": "üêõ",
                "color": "border-red-500",
                "questions": [
                    { "q": "No Manejo Agroecol√≥gico de Pragas (MAP), qual conceito determina o momento ideal para a interven√ß√£o, pois o custo do dano excederia o custo do controle?", "a": ["N√≠vel de Saneamento Fitossanit√°rio (NSF)", "N√≠vel de Dano Econ√¥mico (NDE)", "Ponto de Equil√≠brio Populacional (PEP)", "√çndice de Resili√™ncia Ecol√≥gica (IRE)"], "c": 1, "r": "O NDE representa o ponto em que o custo da interven√ß√£o se justifica economicamente devido ao n√≠vel de perda potencial de produ√ß√£o." },
                    { "q": "Qual das seguintes a√ß√µes humanas √© identificada como uma das causas prim√°rias do desequil√≠brio ecol√≥gico que leva ao aumento de surtos de pragas (M2 do MAP)?", "a": ["Utiliza√ß√£o excessiva de compostagem org√¢nica e bokashi", "O uso de rota√ß√£o de culturas em ciclos curtos e intensivos", "Monocultivos extensivos, oferecendo fonte alimentar homog√™nea e ilimitada", "Plantio de bordaduras de esp√©cies repelentes ao redor dos talh√µes"], "c": 2, "r": "A simplifica√ß√£o do ambiente agr√≠cola (monocultura) e a elimina√ß√£o da diversidade criam condi√ß√µes ideais para o crescimento exponencial de pragas." },
                    { "q": "De acordo com o Minicurso MAP (M5), qual √© o nome do agente biocontrolador bacteriano recomendado para o controle seletivo de larvas e lagartas?", "a": ["Beauveria bassiana", "Pochonia chlamydosporia", "<i>Bacillus thuringiensis</i> (Bt)", "<i>Trichogramma pretiosum</i>"], "c": 2, "r": "O Bt √© uma bact√©ria que produz uma toxina que √© seletiva e letal para o sistema digestivo de larvas e lagartas, sendo um bioinseticida bacteriano de refer√™ncia." },
                    { "q": "Segundo o Minicurso MAP (M4), qual nutriente, quando em excesso, tende a atrair pragas sugadoras?", "a": ["F√≥sforo (P)", "Pot√°ssio (K)", "Nitrog√™nio (N)", "C√°lcio (Ca)"], "c": 2, "r": "O excesso de Nitrog√™nio promove um tecido vegetal mais tenro e suculento, tornando-o mais atrativo e nutritivo para pragas sugadoras como pulg√µes." },
                    { "q": "A Calda de Pimenta, Alho e Sab√£o (M1 do Guia Pr√°tico) √© utilizada principalmente por qual mecanismo de a√ß√£o contra moscas e tripes?", "a": ["A√ß√£o sist√™mica via raiz, inibindo a alimenta√ß√£o.", "Efeito fungicida e bactericida (dupla a√ß√£o), eliminando doen√ßas.", "Forte a√ß√£o repelente e inseticida de contato (ruptura da cut√≠cula pelo sab√£o).", "Inibi√ß√£o da metamorfose e da oviposi√ß√£o dos insetos."], "c": 2, "r": "A combina√ß√£o do forte odor da Pimenta/Alho (repel√™ncia) com o sab√£o (que rompe a cut√≠cula dos insetos) garante a efic√°cia da calda." }
                ]
            },
            "M2": {
                "title": "Manejo de Doen√ßas (MAD)",
                "icon": "ü¶†",
                "color": "border-blue-500",
                "questions": [
                    { "q": "De acordo com o Minicurso MAD, qual fator do Tri√¢ngulo da Doen√ßa √© manipulado ao aplicar a estrat√©gia de 'Evas√£o'?", "a": ["Hospedeiro Suscet√≠vel", "Agente Causal (Pat√≥geno)", "Ambiente Favor√°vel", "Vetor de Dissemina√ß√£o"], "c": 2, "r": "A Evas√£o consiste em usar √©pocas ou locais que s√£o menos prop√≠cios (ou seja, menos favor√°veis) para o desenvolvimento do pat√≥geno." },
                    { "q": "Segundo o Minicurso MAD (M7), qual t√©cnica de controle f√≠sico utiliza filme pl√°stico por 4 a 6 semanas para elevar a temperatura do solo e eliminar in√≥culos superficiais?", "a": ["Termoterapia", "Solariza√ß√£o do Solo", "Compostagem Termof√≠lica", "Saneamento Mec√¢nico"], "c": 1, "r": "A solariza√ß√£o usa a radia√ß√£o solar capturada por filme pl√°stico para aquecer e desinfestar a camada superficial do solo." },
                    { "q": "Qual dos seguintes √© um agente biocontrolador de nematoides, frequentemente usado em estrat√©gias de Bio-Supress√£o (M6 do MAD)?", "a": ["<i>Bacillus thuringiensis</i> (Bt)", "<i>Metarhizium anisopliae</i>", "<i>Pochonia chlamydosporia</i>", "<i>Trichogramma pretiosum</i>"], "c": 2, "r": "Este √© um fungo nemat√≥fago reconhecido por sua capacidade de parasitar ovos de nematoides, sendo um biocontrolador espec√≠fico para esse alvo." },
                    { "q": "Segundo o Minicurso MAD (M5), a incorpora√ß√£o de res√≠duos de br√°ssicas no solo tem qual a√ß√£o prim√°ria contra pat√≥genos?", "a": ["A√ß√£o larvicida via produ√ß√£o de prote√≠nas Bt", "Libera√ß√£o de isotiocianatos, com a√ß√£o fungicida natural no solo", "Eleva√ß√£o do pH do solo para inibir a acidez", "Est√≠mulo √† fixa√ß√£o biol√≥gica de Nitrog√™nio na rizosfera"], "c": 1, "r": "A decomposi√ß√£o das br√°ssicas libera isotiocianatos, que possuem reconhecida a√ß√£o fungicida e nematicida natural no solo." },
                    { "q": "O Extrato de Primavera (<i>Bougainvillea sp.</i>), listado no Guia Pr√°tico (M2), √© utilizado para reduzir a incid√™ncia de qual tipo de agente etiol√≥gico em culturas como o tomateiro?", "a": ["Nematoides do solo (<i>Meloidogyne spp.</i>).", "V√≠rus (como o Vira-cabe√ßa do tomateiro).", "√Åcaros e tripes (pragas sugadoras).", "Fungos de solo (<i>Rhizoctonia solani</i>)."], "c": 1, "r": "O Extrato de Primavera √© um dos poucos bioinsumos citados por ter uma a√ß√£o inibit√≥ria e redutora na incid√™ncia de viroses." }
                ]
            },
            "M3": {
                "title": "Manejo de Daninhas (MSPD)",
                "icon": "üåø",
                "color": "border-green-500",
                "questions": [
                    { "q": "Qual √© a principal indica√ß√£o ambiental do solo associada √† presen√ßa da planta daninha Samambaia (<i>Pteridium arachnoideum</i>), conforme detalhado no Minicurso MSPD (M2)?", "a": ["Compacta√ß√£o e alta densidade", "Solos √°cidos e presen√ßa de alum√≠nio t√≥xico", "Solos f√©rteis e bem corrigidos", "D√©ficit h√≠drico e baixa mat√©ria org√¢nica"], "c": 1, "r": "A Samambaia √© uma bioindicadora cl√°ssica de solos que necessitam de corre√ß√£o de acidez (calagem) para serem f√©rteis para outras culturas." },
                    { "q": "Segundo o Minicurso MSPD (M5), como a palhada (mulch) no Plantio Direto atua como principal mecanismo de supress√£o de plantas daninhas fotobl√°sticas?", "a": ["Aumentando a compacta√ß√£o superficial, impedindo o desenvolvimento radicular", "Elevando a temperatura do solo a n√≠veis letais (solariza√ß√£o)", "Liberando compostos alelop√°ticos que inibem a divis√£o celular", "Atuando como barreira f√≠sica que impede a passagem de luz (sombreamento)"], "c": 3, "r": "As esp√©cies fotobl√°sticas necessitam de luz para germinar. A palhada atua como um 'abafamento' f√≠sico que interrompe esse est√≠mulo." },
                    { "q": "Qual √© o principal risco associado ao revolvimento frequente do solo (ara√ß√£o/gradagem) para o manejo de plantas daninhas, conforme o Minicurso MSPD (M4)?", "a": ["Redu√ß√£o do n√≠vel de nitrog√™nio dispon√≠vel no solo", "Est√≠mulo √† germina√ß√£o de sementes dormentes (banco de sementes)", "Aumento da popula√ß√£o de predadores naturais", "Acelera√ß√£o da decomposi√ß√£o da palhada"], "c": 1, "r": "O revolvimento exp√µe sementes dormentes √† luz e a condi√ß√µes de umidade favor√°veis, mobilizando o banco de sementes e piorando a infesta√ß√£o." },
                    { "q": "No MSPD (M6), qual m√©todo f√≠sico utiliza energia para a elimina√ß√£o pontual de plantas daninhas, sendo uma alternativa ao uso de herbicidas em √°reas espec√≠ficas?", "a": ["Solariza√ß√£o do solo", "Aplica√ß√£o de fogo/vapor (controle t√©rmico)", "Aplicac√£o de descargas el√©tricas (Eletricidade)", "Uso de telas e barreiras"], "c": 2, "r": "A aplica√ß√£o de descargas el√©tricas √© um m√©todo f√≠sico de a√ß√£o imediata e pontual, utilizado para elimina√ß√£o de plantas daninhas em √°reas espec√≠ficas." },
                    { "q": "A Crotal√°ria (<i>Crotalaria juncea</i>) √© uma planta de cobertura de alto potencial supressor. O principal mecanismo que ela utiliza para suprimir as daninhas √©:", "a": ["A inibi√ß√£o da ovula√ß√£o de insetos voadores na √°rea de cultivo", "A r√°pida forma√ß√£o de palhada e biomassa, promovendo alelopatia e sombreamento", "A acidifica√ß√£o do solo, eliminando daninhas sens√≠veis ao pH", "A atra√ß√£o de microrganismos entomopatog√™nicos no dossel"], "c": 1, "r": "A alta produ√ß√£o de biomassa e a libera√ß√£o de compostos alelop√°ticos na decomposi√ß√£o s√£o as principais estrat√©gias supressoras da <i>Crotal√°ria</i>." }
                ]
            },
            "M4": {
                "title": "Plantas Repelentes",
                "icon": "üåº",
                "color": "border-amber-500",
                "questions": [
                    { "q": "Qual √© um dos mecanismos prim√°rios pelo qual as Plantas Repelentes, como a Arruda e o Cravo-de-defunto, protegem as culturas, conforme descrito no m√≥dulo M2?", "a": ["Inocula√ß√£o de microrganismos entomopatog√™nicos no solo", "S√≠ntese de azadiractina para inibir a metamorfose dos insetos", "Mascaramento de Odores, confundindo as pragas na localiza√ß√£o da cultura", "Aumento do N√≠vel de Dano Econ√¥mico (NDE) da √°rea de cultivo"], "c": 2, "r": "Os vol√°teis emitidos pelas repelentes interferem na comunica√ß√£o qu√≠mica da praga, impedindo-a de encontrar o alvo (mascaramento olfativo)." },
                    { "q": "Segundo o Minicurso Plantas Repelentes (M3), qual esp√©cie √© especificamente recomendada para cons√≥rcio com o tomateiro para controlar brocas (broca-pequena e broca-grande)?", "a": ["Alecrim (<i>Rosmarinus officinalis</i>)", "Manjeric√£o (<i>Ocimum basilicum</i>)", "Cravo-de-defunto (<i>Tagetes sp.</i>)", "Batata-doce (<i>Ipomoea batatas</i>)"], "c": 2, "r": "O Cravo-de-defunto √© a planta de cons√≥rcio mais conhecida para o tomate, atuando na repuls√£o e controle de nematoides no solo, al√©m de brocas." },
                    { "q": "Qual fator de manejo pr√°tico, quando negligenciado, reduz a produ√ß√£o de √≥leos essenciais e o poder de repuls√£o da planta?", "a": ["O plantio em solo argiloso e pobre em pot√°ssio.", "A realiza√ß√£o de poda excessiva.", "O estresse h√≠drico (solo seco) e a falta de nutrientes essenciais.", "A altern√¢ncia de esp√©cies repelentes no mesmo talh√£o."], "c": 2, "r": "A produ√ß√£o de √≥leos essenciais e compostos arom√°ticos √© um processo metab√≥lico que exige vitalidade, sendo reduzido pelo estresse h√≠drico e nutricional." },
                    { "q": "De acordo com o Minicurso Plantas Repelentes (M4), em qual hor√°rio do dia √© recomendado realizar a pulveriza√ß√£o de extratos arom√°ticos repelentes?", "a": ["Meio-dia, quando o sol est√° mais forte para potencializar a volatilidade.", "Final da tarde, para otimizar a a√ß√£o dos vol√°teis e reduzir a fitotoxidez.", "Manh√£ cedo, antes do orvalho secar.", "Qualquer hor√°rio, desde que o vento esteja fraco."], "c": 1, "r": "O final da tarde garante menor radia√ß√£o solar (evitando a queima) e condi√ß√µes mais est√°veis para que os compostos vol√°teis ajam antes de evaporarem rapidamente." },
                    { "q": "A Batata-doce (<i>Ipomoea batatas</i>) √© listada no Minicurso Plantas Repelentes (M3) com uma fun√ß√£o espec√≠fica na horta. Qual √© ela?", "a": ["Atra√ß√£o de predadores de pulg√µes.", "Fonte de f√≥sforo de libera√ß√£o lenta para o solo.", "Plantio ao redor das hortas como isca e repelente f√≠sico de Formigas Cortadeiras.", "Produ√ß√£o de √≥leos essenciais com efeito nematicida."], "c": 2, "r": "A Batata-doce, com suas folhas atrativas, √© usada como barreira e isca alimentar para desviar o foco das formigas cortadeiras da cultura principal." }
                ]
            },
            "M5": {
                "title": "Guia Nutricional",
                "icon": "ü•ï",
                "color": "border-orange-500",
                "questions": [
                    { "q": "O amarelamento generalizado e intenso nas FOLHAS VELHAS e inferiores da planta √© o sintoma cl√°ssico de defici√™ncia de qual nutriente?", "a": ["Boro (B)", "Pot√°ssio (K)", "Ferro (Fe)", "Nitrog√™nio (N)"], "c": 3, "r": "O Nitrog√™nio √© altamente m√≥vel, sendo translocado para o crescimento novo, o que causa o amarelecimento das folhas mais velhas." },
                    { "q": "Onde os sintomas de defici√™ncia de um nutriente IM√ìVEL (como C√°lcio ou Boro) tendem a se manifestar primeiro?", "a": ["Em frutos e ra√≠zes", "Nas folhas VELHAS (na base da planta)", "Nas folhas JOVENS (nos ponteiros da planta)", "Nos caules e pec√≠olos mais grossos"], "c": 2, "r": "Nutrientes im√≥veis n√£o podem ser translocados, resultando em sintomas no tecido que se forma por √∫ltimo, ou seja, nas folhas jovens." },
                    { "q": "Qual √© a principal causa de defici√™ncia de nutrientes no solo (como o 'aprisionamento' de Ferro, F√≥sforo ou Zinco)?", "a": ["Excesso de irriga√ß√£o (lixivia√ß√£o)", "Desequil√≠brio de pH inadequado (muito √°cido ou muito alcalino)", "Baixa temperatura do solo", "Falta de micronutrientes no adubo org√¢nico"], "c": 1, "r": "O pH inadequado do solo impede que os nutrientes sejam liberados ou absorvidos pela planta, sendo a principal causa de defici√™ncias." },
                    { "q": "A 'Podrid√£o Apical' (ou 'Fundo Preto') em Piment√£o e Tomateiro √© o sintoma cl√°ssico de defici√™ncia de qual nutriente?", "a": ["Pot√°ssio (K)", "Nitrog√™nio (N)", "C√°lcio (Ca)", "Magn√©sio (Mg)"], "c": 2, "r": "A Podrid√£o Apical √© causada pela defici√™ncia de C√°lcio no fruto, muitas vezes agravada por estresse h√≠drico, que impede sua transloca√ß√£o." },
                    { "q": "Qual das seguintes Boas Pr√°ticas de Manejo Nutricional deve ser realizada para garantir a m√°xima disponibilidade de todos os nutrientes?", "a": ["Aplicar B√≥rax preventivamente em todas as culturas.", "Manter o pH do solo entre 5,5 e 6,5.", "Realizar aduba√ß√£o de cobertura uma √∫nica vez no ciclo.", "Aumentar a condutividade el√©trica (CE) da solu√ß√£o nutritiva."], "c": 1, "r": "Este intervalo de pH √© o ideal para otimizar a solubilidade e absor√ß√£o da maioria dos macro e micronutrientes essenciais pela planta." }
                ]
            },
            "M6": {
                "title": "Guia Pr√°tico (Receitas)",
                "icon": "üß™",
                "color": "border-purple-500",
                "questions": [
                    { "q": "Qual √© um dos principais benef√≠cios da Calda Vi√ßosa, al√©m de sua a√ß√£o fungicida preventiva, conforme o Guia Pr√°tico Agroecol√≥gico?", "a": ["Elevar o pH do solo para inibir a germina√ß√£o de esporos", "Fornecer micronutrientes como Cobre, Zinco, Magn√©sio e Boro", "Atuar como larvicida seletivo contra lagartas em fase inicial", "Estimular microrganismos ben√©ficos no solo (Bioativa√ß√£o)"], "c": 1, "r": "A Calda Vi√ßosa √© formulada com sais (CuSO‚ÇÑ, ZnSO‚ÇÑ, MgSO‚ÇÑ, H‚ÇÉBO‚ÇÉ) que agem como fungicidas e fortificantes foliares." },
                    { "q": "A Fermenta√ß√£o de um Biofertilizante Aer√≥bio por 15 dias tem qual fun√ß√£o prim√°ria no Manejo Agroecol√≥gico?", "a": ["Esteriliza√ß√£o do material para elimina√ß√£o de pat√≥genos (fun√ß√£o t√©rmica).", "S√≠ntese de azadiractina para efeito inseticida.", "Repovoamento do solo com microrganismos ben√©ficos (Bioativa√ß√£o) e indu√ß√£o de resist√™ncia.", "Descompacta√ß√£o qu√≠mica do solo via aumento do pH."], "c": 2, "r": "A fermenta√ß√£o visa multiplicar microrganismos ben√©ficos que atuar√£o no solo como antagonistas de pat√≥genos e como bioestimulantes de crescimento." },
                    { "q": "A Calda Sulfoc√°lcica √© um produto multiuso de alta efici√™ncia. Qual √© o principal grupo de pragas/doen√ßas que ela ajuda a combater em frut√≠feras e cafezais?", "a": ["Nematoides do solo e fungos radiculares.", "√Åcaros, cochonilhas, ferrugens e fumagina.", "Lagartas desfolhadoras e brocas.", "Viroses (como o v√≠rus do vira-cabe√ßa)."], "c": 1, "r": "A Calda Sulfoc√°lcica √© conhecida por sua alta efic√°cia como acaricida, inseticida (cochonilhas) e fungicida (ferrugens e fumagina)." },
                    { "q": "Qual √© a principal fun√ß√£o da Cobertura Morta (Mulching) no manejo de plantas daninhas (M3 do Guia Pr√°tico)?", "a": ["Acelerar a lixivia√ß√£o de nutrientes.", "Reduzir a luz, dificultando a germina√ß√£o de invasoras e melhorando a umidade do solo.", "Fornecer grandes quantidades de nitrog√™nio (N) imediatamente ap√≥s a aplica√ß√£o.", "Atuar como armadilha adesiva para insetos voadores."], "c": 1, "r": "A palhada atua como barreira f√≠sica √† luz e t√©rmica, inibindo a germina√ß√£o e mantendo a umidade do solo, sendo seu principal benef√≠cio." },
                    { "q": "A Calda Sulfoc√°lcica deve ser aplicada em hor√°rios frescos e dilu√≠da. Qual √© o principal componente que confere a ela as propriedades acaricidas e fungicidas?", "a": ["O Cobre (Cu) do sulfato (como na Calda Bordalesa).", "Os compostos sulfurados (Enxofre) e o pH elevado (Cal).", "A glicose do mela√ßo para alimentar microrganismos.", "O Bicarbonato de S√≥dio, que eleva o pH foliar."], "c": 1, "r": "A Calda Sulfoc√°lcica √© o resultado da rea√ß√£o do Enxofre em p√≥ com a Cal virgem, formando polissulfetos que t√™m a√ß√£o acaricida/fungicida." }
                ]
            }
        };

        let quizState = {};

        function initializeState() {
            Object.keys(QUIZ_DATA).forEach(moduleId => {
                quizState[moduleId] = {
                    currentQ: 0,
                    score: 0,
                    answered: Array(QUIZ_DATA[moduleId].questions.length).fill(false),
                    completed: false
                };
            });
            renderHubCards();
            // Adicionado para inicializar a navega√ß√£o principal
            const navLinks = document.querySelectorAll('.nav-link');
            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    const targetId = e.currentTarget.dataset.target;
                    showPage(targetId);
                });
            });
        }

        function renderHubCards() {
            const container = document.getElementById('hub-cards-container');
            container.innerHTML = '';
            
            Object.keys(QUIZ_DATA).forEach(moduleId => {
                const moduleData = QUIZ_DATA[moduleId];
                const state = quizState[moduleId];
                const card = document.createElement('div');
                const progressColor = state.score === 5 ? 'bg-green-100 border-green-600' : 'bg-white border-gray-300';
                
                card.className = `module-card p-4 rounded-lg shadow-md border-l-4 ${progressColor} flex flex-col justify-between`;
                card.onclick = () => showPage(moduleId);
                
                card.innerHTML = `
                    <div class="flex items-center mb-3">
                        <span class="text-3xl mr-3">${moduleData.icon}</span>
                        <h4 class="text-xl font-bold text-gray-900">${moduleData.title}</h4>
                    </div>
                    <div>
                        <p class="text-sm text-gray-600 mb-2">5 Quest√µes</p>
                        <p class="text-lg font-extrabold text-emerald-600">
                            Pontua√ß√£o: ${state.score} / 5
                            <span class="text-xs font-normal ${state.score > 0 ? 'text-emerald-500' : 'text-gray-500'}">
                                ${state.score === 5 ? ' (Conclu√≠do!)' : ''}
                            </span>
                        </p>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        function createQuizSections() {
            const quizContentDiv = document.getElementById('quiz-content');
            quizContentDiv.innerHTML = '';

            Object.keys(QUIZ_DATA).forEach(moduleId => {
                const moduleData = QUIZ_DATA[moduleId];
                const section = document.createElement('section');
                section.id = `page-${moduleId}`;
                section.className = 'content-page';
                section.innerHTML = `
                    <div class="bg-white shadow-xl rounded-lg p-6 md:p-8 border-l-4 ${moduleData.color}">
                        <h2 class="text-2xl font-bold text-gray-900 mb-4">${moduleData.icon} ${moduleData.title}</h2>
                        <div id="q-container-${moduleId}">
                            <!-- Quest√£o ser√° injetada aqui -->
                        </div>
                        <div class="mt-6 pt-4 border-t border-gray-200 flex justify-between items-center">
                            <p class="text-sm text-gray-600">Pontua√ß√£o no M√≥dulo: <span id="score-${moduleId}">${quizState[moduleId].score}</span> / 5</p>
                            <button id="next-btn-${moduleId}" class="bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-2 px-4 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed">
                                Pr√≥xima Quest√£o
                            </button>
                        </div>
                    </div>
                `;
                quizContentDiv.appendChild(section);
                renderQuestion(moduleId);
            });
        }

        function renderQuestion(moduleId) {
            const state = quizState[moduleId];
            const moduleData = QUIZ_DATA[moduleId];
            const container = document.getElementById(`q-container-${moduleId}`);
            const nextBtn = document.getElementById(`next-btn-${moduleId}`);
            nextBtn.disabled = true;
            nextBtn.onclick = () => {
                state.currentQ++;
                renderQuestion(moduleId);
            };

            if (state.currentQ >= moduleData.questions.length) {
                // Marks the module as completed upon reaching the end
                state.completed = true;
                
                container.innerHTML = `<h3 class="text-xl font-bold text-emerald-600">M√≥dulo Conclu√≠do!</h3>
                                       <p class="text-gray-700 mt-2">Sua pontua√ß√£o final neste m√≥dulo foi de ${state.score} / 5.</p>
                                       <button class="mt-4 bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-2 px-4 rounded-lg transition-colors" onclick="showNextModule('${moduleId}')">
                                           Ir para o Pr√≥ximo M√≥dulo
                                       </button>`;
                nextBtn.style.display = 'none';
                
                updateModuleScoreDisplay(moduleId);
                renderHubCards();
                return;
            }

            nextBtn.style.display = 'inline-block';
            const qIndex = state.currentQ;
            const question = moduleData.questions[qIndex];
            const alreadyAnswered = state.answered[qIndex];

            container.innerHTML = `
                <p class="text-lg font-semibold mb-4"><span class="font-bold">Quest√£o ${qIndex + 1}</span>: ${question.q}</p>
                <div class="space-y-3" id="options-container-${moduleId}">
                    ${question.a.map((option, index) => {
                        const isCorrect = (index === question.c);
                        let classes = 'answer-option w-full text-left p-3 border-2 border-gray-200 rounded-lg bg-white';
                        let disabled = '';
                        let onclick = `checkAnswer('${moduleId}', ${index})`;

                        if (alreadyAnswered !== false) {
                            disabled = 'disabled';
                            onclick = '';
                            classes += ' disabled';
                            if (index === question.c) {
                                classes += ' correct';
                            } else if (index === alreadyAnswered) {
                                classes += ' incorrect';
                            }
                        }

                        return `<button class="${classes}" data-option="${index}" onclick="${onclick}" ${disabled}>
                            ${String.fromCharCode(65 + index)}. ${option}
                        </button>`;
                    }).join('')}
                </div>
                <div id="feedback-${moduleId}" class="mt-4 p-4 rounded-lg ${alreadyAnswered !== false ? '' : 'hidden'}">
                    ${alreadyAnswered !== false ? 
                        (alreadyAnswered === question.c) ? 
                        `<span class="font-bold text-green-700">Correto!</span> ${question.r}` : 
                        `<span class="font-bold text-red-700">Incorreto.</span> Resposta correta: ${String.fromCharCode(65 + question.c)}. ${question.a[question.c]}. <br> <span class="font-semibold">Justificativa:</span> ${question.r}`
                    : ''}
                </div>
            `;
            // For√ßar o bot√£o Pr√≥ximo a ficar habilitado se j√° respondida
            if (alreadyAnswered !== false) {
                nextBtn.disabled = false;
            }

            updateModuleScoreDisplay(moduleId);
        }

        function checkAnswer(moduleId, selectedIndex) {
            const state = quizState[moduleId];
            const moduleData = QUIZ_DATA[moduleId];
            const qIndex = state.currentQ;
            const question = moduleData.questions[qIndex];
            const correctIndex = question.c;
            const optionsContainer = document.getElementById(`options-container-${moduleId}`);
            const feedbackDiv = document.getElementById(`feedback-${moduleId}`);
            const nextBtn = document.getElementById(`next-btn-${moduleId}`);

            if (state.answered[qIndex] !== false) {
                return; // J√° respondida, n√£o faz nada
            }

            let isCorrect = (selectedIndex === correctIndex);

            // Desabilitar todas as op√ß√µes e aplicar classes de cor
            Array.from(optionsContainer.children).forEach((btn, index) => {
                btn.classList.add('disabled');
                btn.disabled = true;
                if (index === correctIndex) {
                    btn.classList.add('correct');
                } else if (index === selectedIndex) {
                    btn.classList.add('incorrect');
                }
            });

            // Salvar resposta e recalcular score (para garantir que s√≥ pontua uma vez)
            let currentScore = 0;
            const answeredCopy = [...state.answered];
            answeredCopy[qIndex] = selectedIndex;

            answeredCopy.forEach((answerIndex, index) => {
                if (answerIndex !== false && answerIndex === moduleData.questions[index].c) {
                    currentScore++;
                }
            });

            state.score = currentScore;
            state.answered = answeredCopy; 

            // Atualizar score e feedback
            if (isCorrect) {
                feedbackDiv.classList.remove('hidden', 'incorrect');
                feedbackDiv.classList.add('correct');
                feedbackDiv.innerHTML = `<span class="font-bold">Correto!</span> ${question.r}`;
            } else {
                feedbackDiv.classList.remove('hidden', 'correct');
                feedbackDiv.classList.add('incorrect');
                feedbackDiv.innerHTML = `<span class="font-bold">Incorreto.</span> Resposta correta: ${String.fromCharCode(65 + correctIndex)}. ${question.a[correctIndex]}. <br> <span class="font-semibold">Justificativa:</span> ${question.r}`;
            }

            nextBtn.disabled = false;
            updateModuleScoreDisplay(moduleId);
            renderHubCards();
        }

        function updateModuleScoreDisplay(moduleId) {
            const scoreSpan = document.getElementById(`score-${moduleId}`);
            if (scoreSpan) {
                scoreSpan.textContent = quizState[moduleId].score;
            }
        }
        
        // NOVO: Fun√ß√£o para ativar a exibi√ß√£o de uma p√°gina (sem recurs√£o)
        function activatePage(pageId, targetId) {
            const navLinks = document.querySelectorAll('.nav-link');
            const contentPages = document.querySelectorAll('.content-page');

            contentPages.forEach(page => {
                page.classList.remove('active');
            });

            const targetPage = document.getElementById(pageId);
            if (targetPage) {
                targetPage.classList.add('active');
            }

            navLinks.forEach(link => {
                link.classList.remove('active-link');
                if (link.dataset.target === targetId) {
                    link.classList.add('active-link');
                }
            });
            window.scrollTo(0, 0);
        }

        function showPage(targetId) {
            // Check if the target is the final summary page and if it's accessible
            if (targetId === 'page-final') {
                showFinalSummary(); // This function handles the security check and calls activatePage if successful
                return;
            }
            
            const pageId = targetId.startsWith('M') ? `page-${targetId}` : targetId;
            
            // Activate the page using the helper
            activatePage(pageId, targetId);

            // Se for um m√≥dulo de quiz, re-renderizar para garantir o estado atualizado da quest√£o
            if (targetId.startsWith('M')) {
                renderQuestion(targetId);
            }
        }

        function showNextModule(currentModuleId) {
            const moduleKeys = Object.keys(QUIZ_DATA);
            
            // 1. Find the first *uncompleted* module in sequential order
            let nextUncompletedId = null;

            for (const moduleId of moduleKeys) {
                if (!quizState[moduleId].completed) {
                    nextUncompletedId = moduleId;
                    break;
                }
            }

            if (nextUncompletedId) {
                // Redirect to the first uncompleted module found
                showPage(nextUncompletedId);
            } else {
                // If all are completed, show the final summary
                showFinalSummary(); 
            }
        }

        function getScoreClassification(score) {
            if (score === 5) {
                return '<span class="text-green-700 font-extrabold">Excelente</span>';
            } else if (score === 4) {
                return '<span class="text-blue-700 font-extrabold">√ìtimo</span>';
            } else {
                // Remove negative phrasing, return empty string for neutral/low scores
                return ''; 
            }
        }

        function showFinalSummary() {
            // 1. Check if all modules are completed
            const moduleKeys = Object.keys(QUIZ_DATA);
            const allCompleted = moduleKeys.every(id => quizState[id].completed);

            if (!allCompleted) {
                // If not all modules are completed, redirect to the first uncompleted one.
                for (const moduleId of moduleKeys) {
                    if (!quizState[moduleId].completed) {
                        showPage(moduleId); // Correct redirection to the missing module
                        return; 
                    }
                }
                showPage('page-intro');
                return;
            }

            // 2. If all completed, generate and show summary
            let totalScore = 0;
            const summaryList = document.getElementById('final-summary-list');
            summaryList.innerHTML = '';

            Object.keys(QUIZ_DATA).forEach(moduleId => {
                const state = quizState[moduleId];
                const moduleTitle = QUIZ_DATA[moduleId].title;
                totalScore += state.score;
                const classification = getScoreClassification(state.score);

                const listItem = document.createElement('li');
                
                // Determine base color (neutral grey unless high score)
                let scoreColor = 'text-gray-700';
                if (state.score === 5) scoreColor = 'text-green-700';
                else if (state.score === 4) scoreColor = 'text-blue-700';

                // The classification text is already bolded/colored via getScoreClassification
                listItem.className = `${scoreColor} font-semibold`;
                listItem.innerHTML = `
                    <span class="text-gray-800 font-semibold">${moduleTitle}:</span> 
                    ${state.score} / 5 
                    <span class="text-sm font-normal">${classification ? `(${classification})` : ''}</span>
                `;
                summaryList.appendChild(listItem);
            });

            document.getElementById('final-total-score').textContent = `${totalScore} / 30`;
            
            // ATEN√á√ÉO: Chamada corrigida para ativar a p√°gina final sem recurs√£o
            activatePage('page-final', 'page-final'); 
        }

        document.addEventListener('DOMContentLoaded', () => {
            // Inicializa√ß√£o movida para o DOMContentLoaded
            initializeState();
            createQuizSections();
            showPage('page-intro'); 
            document.querySelector('.nav-link[data-target="page-intro"]').classList.add('active-link');
        });
    </script>

</body>
</html>